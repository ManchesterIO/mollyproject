{% extends "core/base.xhtml" %}
{% load maps %}

{% block stylesheets %}
{{ block.super }}
    <link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/core/index.css"/>
{% endblock %}

{% block content %}

    <h1 class="nodisplay">Home</h1>

    <div class="section">
        <h2 class="nodisplay">Menu</h2>
    

    <ul class="icon-menu">
{% for link in front_page_links %}
      <li id="menu-{{ link.slug }}">
          <a href="{{ link.url }}">{{ link.title }}</a>
      </li>
{% endfor %}
    </ul>
    <div class="clearhidden"> </div>
    
{% if user.is_authenticated %}
    <p><a href="{% url core_customise %}">Customise</a></p>
{% endif %}
    
    </div>
    <hr/>
    <div class="section">
        <h2>Location</h2>
{% if placemark %}
        <p id="location_status">We think you are somewhere near <strong class="nobr">{{ placemark.address }}</strong> ({{ location.0 }} {{ location.1 }}).</p>
        <p id="location_update"><a href="{% url core_update_location %}">This is not correct</a></p>
{% else %}
{% if location %}
        <p id="location_status">We think you are somewhere near <strong class="nobr">{{ location.0 }} {{ location.1 }}</strong>.</p>
        <p id="location_update"><a href="{% url core_update_location %}">This is not correct</a></p>
{% else %}
        <p id="location_status">Sorry, but we are unable to determine your location automatically.</p>
        <script type="text/javascript">
            if (require_location && navigator.geolocation.getCurrentPosition)
                $('#location_status').html('We do not yet have a location for you; please wait while we attempt to determine one.');
            else if (navigator.geolocation.getCurrentPosition)
                $('#location_status').css('display', 'none');
        </script>
        <p id="location_update"><a href="{% url core_update_location %}">Update your location manually</a></p>
{% endif %}
{% endif %}
        <script type="text/javascript">
            if (navigator.geolocation.getCurrentPosition)
                $('#location_update').append(' <a href="#" onclick="javascript:requestPosition();">Determine automatically<\/a>');
        </script>
        
{% if location %}{% map location %}{% endif %}
    
    </div>
    <hr/>
    <div class="section">
        <h2>Using this site</h2>
        <p>
            <a href="/help/">Help</a>
        </p>
    </div>
{% if user.is_superuser %}
    <hr/>
    <div class="section">
        <h2>Session</h2>
        <p>{{ session }}</p>
    </div>

    <hr/>
    <div class="section">
        <h2>Device</h2>
        <p>{{ device.brand_name }} {{ device.model_name }} ({{ device.devid }})</p>
    </div>
    
    <hr/>
    <div class="section">
        <h2>Meta</h2>
        <dl>
{% for a,b in meta.items %}
            <dt>{{ a }}</dt>
            <dd>{{ b }}</dd>
{% endfor %}
        </dl>
    </div>
{% endif %}
{% endblock %}
