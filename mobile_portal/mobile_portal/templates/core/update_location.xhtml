{% extends "core/base.xhtml" %}
{% load maps %}

{% block pagetitle %}Update location{% endblock %}

{% block content %}

{% if error %}

<p><em>{{ error }}</em></p>

{% endif %}

{% if options %}

<div class="list-section">

<h2 class="section-header">Did you mean:</h2>

<form method="post" action=".">
<input type="hidden" name="location" value="{{ location }}"/>
<ul class="ml">
{% for option in options %}
    <li><button class="as_link" type="submit" name="index" value="{{ forloop.counter0 }}" style="width:100%">{{ option.address }}</button></li>
{% endfor %}
</ul>
</form>

</div>

{% endif %}

<div class="section-nopad">

<h2 class="section-header">{% if options %}Alternatively, please try another search:{% else %}Please enter an address or postcode:{% endif %}</h2>

<div class="section-content"><div class="bubble">Examples: 'oucs' (a unit code), 'Trinity College' (a college or department), 'Parks Road' (an address), 'OX1 3PG' (a postcode).</div></div>


<form method="post" action=".">
    <div class="section-content">
      <div class="submit-line">
{% if return_url %}
        <input name="return_url" type="hidden" value="{{ return_url }}"/>
{% endif %}
        <input id="location" name="location" value="{{ location }}"/>
        <input type="submit" value="Update"/>
        
      </div>
    </div>

</form>

</div>


{% if preferences.location.placemark %}
        <p id="location_status">We think you are somewhere near <strong class="nobr">{{ preferences.location.placemark.address }}</strong> ({{ preferences.location.location.0 }} {{ preferences.location.location.1 }}).</p>
{% else %}
{% if preferences.location.location %}
        <p id="location_status">We think you are somewhere near <strong class="nobr">{{ preferences.location.location.0 }} {{ preferences.location.location.1 }}</strong>.</p>
{% else %}
        <p id="location_status">Sorry, but we are unable to determine your location automatically.</p>
        <script type="text/javascript">
            if (require_location && positionMethodAvailiable())
                $('#location_status').html('We do not yet have a location for you; please wait while we attempt to determine one.');
            else if (positionMethodAvailiable())
                $('#location_status').css('display', 'none');
        </script>
{% endif %}
{% endif %}
<p id="location_update"> </p>
        <script type="text/javascript">
            if (positionMethodAvailable())
                $('#location_update').append(' <a href="#" onclick="javascript:requestPosition();">Determine automatically<\/a>');
        </script>
        
{% if preferences.location.location %}{% map preferences.location.location %}{% endif %}


{% endblock %}
