{% extends "core/base.xhtml" %}
{% load maps %}

{% block content %}

<h1>Update location manually</h1>

{% if error %}

<p><em>{{ error }}</em></p>

{% endif %}

{% if options %}

<p>Did you mean:</p>

<form method="post" action=".">
<input type="hidden" name="location" value="{{ location }}"/>
<ul>
{% for option in options %}
    <li><button class="as_link" type="submit" name="index" value="{{ forloop.counter0 }}">{{ option.address }}</button></li>
{% endfor %}
</ul>
</form>

<p>Alternatively, please try another search:</p>

{% else %}

<p>Please enter an address or postcode (e.g. 'Keble College', 'Parks Road', 'OX1 3PG')</p>

{% endif %}

<form method="post" action=".">
    <p>
        <input name="location" value="{{ location }}"/>
{% if return_url %}
        <input name="return_url" type="hidden" value="{{ return_url }}"/>
{% endif %}
        <input type="submit" value="Update"/>
    </p>
</form>

<hr/>



{% if preferences.location.placemark %}
        <p id="location_status">We think you are somewhere near <strong class="nobr">{{ preferences.location.placemark.address }}</strong> ({{ preferences.location.location.0 }} {{ preferences.location.location.1 }}).</p>
{% else %}
{% if preferences.location.location %}
        <p id="location_status">We think you are somewhere near <strong class="nobr">{{ preferences.location.location.0 }} {{ preferences.location.location.1 }}</strong>.</p>
{% else %}
        <p id="location_status">Sorry, but we are unable to determine your location automatically.</p>
        <script type="text/javascript">
            if (require_location && positionMethodAvailiable())
                $('#location_status').html('We do not yet have a location for you; please wait while we attempt to determine one.');
            else if (positionMethodAvailiable())
                $('#location_status').css('display', 'none');
        </script>
{% endif %}
{% endif %}
<p id="location_update"> </p>
        <script type="text/javascript">
            if (navigator.geolocation.getCurrentPosition || google.gears)
                $('#location_update').append(' <a href="#" onclick="javascript:requestPosition();">Determine automatically<\/a>');
        </script>
        
{% if preferences.location.location %}{% map preferences.location.location %}{% endif %}


{% endblock %}
