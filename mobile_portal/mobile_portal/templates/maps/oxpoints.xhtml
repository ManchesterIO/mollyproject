{% extends "maps/base.xhtml" %}
{% load maps %}{% load portal_misc %}

{% block title %}OMP | {{ data.dc_title }}{% endblock %}

{% block content %}

<h1>{{ data.dc_title }}</h1>

<p>
    <a href="{% url maps_entity_nearby_list entity.entity_type.slug,entity.display_id %}">Find things near here</a>
</p>

<dl>

{% if data.oxp_hasHomepage or data.oxp_hasITHomepage or data.oxp_hasWeblearn or data.oxp_hasLibraryHomepage %}
<dt>Websites</dt>

{% if data.oxp_hasHomepage %}
    <dd><a href="{{ data.oxp_hasHomepage.uri }}">Homepage</a></dd>
{% endif %}
{% if data.oxp_hasITHomepage %}
    <dd><a href="{{ data.oxp_hasITHomepage.uri }}">IT Homepage</a></dd>
{% endif %}
{% if data.oxp_hasWeblearn %}
    <dd><a href="{{ data.oxp_hasWeblearn.uri }}">Weblearn</a></dd>
{% endif %}
{% if data.oxp_hasLibraryHomepage %}
    <dd><a href="{{ data.oxp_hasLibraryHomepage.uri }}">Library</a></dd>
{% endif %}
{% endif %}

{% if data.oxp_occupies %}
<dt>Occupies</dt>

{% for place in data.oxp_occupies %}
{% with place|load_oxp_json as place_json %}
    <dd><a href="{{ place_json|oxp_portal_url }}">{{ place_json.dc_title }}</a></dd>
{% endwith %}
{% endfor %}

{% endif %}

{% if data.passiveProperties.oxp_occupies %}
<dt>Occupied by</dt>

{% for place in data.passiveProperties.oxp_occupies %}
{% with place|load_oxp_json as place_json %}
    <dd><a href="{{ place_json|oxp_portal_url }}">{{ place_json.dc_title }}</a></dd>
{% endwith %}
{% endfor %}

{% endif %}

{% if data.oxp_subsetOf %}
<dt>Parent unit</dt>
{% with data.oxp_subsetOf|load_oxp_json as place_json %}
<dd><a href="{{ place_json|oxp_portal_url }}">{{ place_json.dc_title }}</a></dd>
{% endwith %}
{% endif %}

{% if data.passiveProperties.oxp_subsetOf %}
<dt>Sub-units</dt>

{% for place in data.passiveProperties.oxp_subsetOf %}
{% with place|load_oxp_json as place_json %}
    <dd><a href="{{ place_json|oxp_portal_url }}">{{ place_json.dc_title }}</a></dd>
{% endwith %}
{% endfor %}

{% endif %}

{% if data.oxp_physicallyContainedWithin %}
<dt>Contained within</dt>

{% with data.oxp_physicallyContainedWithin|load_oxp_json as place_json %}
    <dd><a href="{{ place_json|oxp_portal_url }}">{{ place_json.dc_title }}</a></dd>
{% endwith %}

{% endif %}

{% if data.passiveProperties.oxp_physicallyContainedWithin %}
<dt>Contains</dt>

{% for place in data.passiveProperties.oxp_physicallyContainedWithin %}
{% with place|load_oxp_json as place_json %}
    <dd><a href="{{ place_json|oxp_portal_url }}">{{ place_json.dc_title }}</a></dd>
{% endwith %}
{% endfor %}

{% endif %}

</dl>

{% if data.oxp_inImage %}
<h2>Images</h2>
{% for image in data.oxp_inImage %}
<p><img src="{% external_image image.uri %}" alt=""/></p>
{% endfor %}
{% endif %}

{% if entity.location %}
    <h2>Map</h2>
    {% map entity.location %}
{% else %}
    <p>We do not yet have a location for this {{ entity.entity_type.verbose_name }}.</p>
{% endif %}

{{ data }}

{% endblock %}
