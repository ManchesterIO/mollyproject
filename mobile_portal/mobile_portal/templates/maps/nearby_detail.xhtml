{% extends "maps/base.xhtml" %}

{% block breadcrumbs %}
{{ block.super }}
{% if entity %}
    <li><a href="{{ entity_type.get_absolute_url }}">{{ entity_type.verbose_name_plural|capfirst }}</a></li>
    <li><a href="{{ entity.get_absolute_url }}">{{ entity.title }}</a></li>
    <li><a href="{% url maps_entity_nearby_detail entity.entity_type.slug,entity.display_id,entity_type.slug %}">Nearest {{ entity_type.verbose_name }}</a></li>
{% else %}    
    <li><a href="{% url maps_nearby_list %}">Find things nearby</a></li>
    <li><a href="{% url maps_nearby_detail entity_type.slug %}">{{ entity_type.verbose_name_plural|capfirst }}</a></li>
{% endif %}
{% endblock %}

{% block content %}

<div class="list-section">
<h2 class="section header">{{ entity_type.verbose_name_plural|capfirst }} within {{ distance }}{% if entity %} of {{ entity.title }}{% endif %}</h2>
</div>
<p>
    Within:
{% for distance in distances %}{% if entity %}
    <a href="{% url maps_entity_nearby_detail_distance entity.entity_type.slug,entity.display_id,entity_type.slug distance.0 %}">{{ distance.1 }}</a>
{% else %}
    <a href="{% url maps_nearby_detail_distance entity_type.slug distance.0 %}">{{ distance.1 }}</a>
{% endif %}{% endfor %}
</p>

<img src="{% url osm_generated_map map_hash %}" alt=""/>

{% if entities %}
<div class="list-section">
<ul class="ml">
{% for entity in entities %}
    <li><a href="{{ entity.get_absolute_url }}">{{ entity.title|linebreaksbr }}</a> {{ entity.distance.km|floatformat:3 }} km {{ entity.bearing }}</li>
{% endfor %}
</ul>
</div>
{% else %}
<p>There isn't anything that close to you. Try <a href="{% url core_update_location %}?return_url={% url maps_nearby_detail entity_type.slug %}">updating your location</a> or widening your search.</p>
{% endif %}

{% endblock %}
